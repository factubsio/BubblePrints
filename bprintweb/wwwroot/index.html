<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Blueprint Explorer</title>
    <link rel="stylesheet" href="/style.css">
    <script>
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        }

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            applyTheme(savedTheme);
        } else {
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(prefersDark ? 'dark' : 'light');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
            });
        });


    </script>
</head>
<body>

    <div class="sticky-header">
        <h1 style="opacity: 0.7">Blueprint Explorer</h1>
        <input id="searchBox" type="text" placeholder="Search blueprints..." autocomplete="off"/>
        <h1 id="currentTitle" style="flex-grow: 1">-</h1>
        <button id="theme-toggle" class="btn" style="margin-right: 1em">Toggle Theme</button>
    </div>

    <!-- results table -->
    <div id="searchView">
        <table id="resultsTable" border="1">
            <thead>
                <!-- column headers will be injected by TypeScript -->
            </thead>
            <tbody>
                <!-- rows will be injected by TypeScript -->
            </tbody>
        </table>
    </div>

    <div id="blueprintView" class="hide">
        <div style="margin-bottom: 1rem;">
            <button id="backBtn" class="btn">&larr; Back to Search</button>
        </div>
        <!-- Tree renders here -->
        <div id="bp-content"></div> 
    </div>

    <script type="module">
        import { initApp } from "/js/app.js";
        initApp();
    </script>
</body>
</html>
